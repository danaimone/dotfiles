# Modern zsh configuration
# Based on work-config setup, optimized for macOS development

# History configuration
HISTFILE=~/.zsh_history
HISTSIZE=10000
SAVEHIST=10000
setopt HIST_IGNORE_DUPS
setopt HIST_IGNORE_ALL_DUPS
setopt HIST_IGNORE_SPACE
setopt HIST_SAVE_NO_DUPS
setopt SHARE_HISTORY

# Enable completion
autoload -U compinit && compinit -u

# Modern CLI tool aliases
if command -v eza &> /dev/null; then
    alias ls="eza --icons"
    alias ll="eza --icons -la"
    alias tree="eza --tree"
fi

if command -v bat &> /dev/null; then
    alias cat="bat"
fi

if command -v rg &> /dev/null; then
    alias grep="rg"
fi

# Core aliases (matching work config style)
alias v="nvim"
alias vim="nvim"
alias c="clear"
alias ..="cd .."
alias ...="cd ../.."
alias ....="cd ../../.."

# Git aliases
alias g="git"
alias gs="git status"
alias ga="git add"
alias gc="git commit"
alias gp="git push"
alias gl="git log --oneline --graph --decorate"
alias gd="git diff"
alias gb="git branch"
alias gco="git checkout"

# Docker aliases (from original config)
alias d="docker"
alias dc="docker-compose"
alias dps="docker ps"
alias dka='docker kill $(docker ps -q) 2>/dev/null || echo "No containers to kill"'

# Custom functions
cdls() { cd "$@" && ls; }
mkcd() { mkdir -p "$@" && cd "$@"; }

# FZF configuration
if command -v fzf &> /dev/null; then
    eval "$(fzf --zsh)"
    export FZF_DEFAULT_COMMAND='fd --type f --hidden --follow --exclude .git'
    export FZF_CTRL_T_COMMAND="$FZF_DEFAULT_COMMAND"
    export FZF_DEFAULT_OPTS="--height 40% --layout=reverse --border"
fi

# Zoxide (smart cd)
if command -v zoxide &> /dev/null; then
    eval "$(zoxide init zsh)"
    alias cd="z"
fi

# Node Version Manager
export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"
[ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion"

# Go configuration
export GOPATH="$HOME/go"
export PATH="$PATH:$GOPATH/bin"

# Rust configuration
if [ -f "$HOME/.cargo/env" ]; then
    source "$HOME/.cargo/env"
fi

# Python configuration
export PATH="$HOME/.local/bin:$PATH"

# Load custom aliases if they exist
[[ -s "$HOME/.bash_aliases" ]] && source "$HOME/.bash_aliases"

# Vi mode with better key bindings
bindkey -v
bindkey '^R' history-incremental-search-backward
bindkey '^[[A' history-substring-search-up
bindkey '^[[B' history-substring-search-down
bindkey '^P' history-substring-search-up
bindkey '^N' history-substring-search-down

# Load zsh plugins for better experience
if command -v brew &> /dev/null; then
    # Syntax highlighting
    if [ -f $(brew --prefix)/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh ]; then
        source $(brew --prefix)/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
    fi

    # Autosuggestions
    if [ -f $(brew --prefix)/share/zsh-autosuggestions/zsh-autosuggestions.zsh ]; then
        source $(brew --prefix)/share/zsh-autosuggestions/zsh-autosuggestions.zsh
    fi
fi

# Initialize starship prompt (keep this at the end)
if command -v starship &> /dev/null; then
    eval "$(starship init zsh)"
fi